(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{1194:function(t,a,e){t.exports=e.p+"assets/img/flask.3ab11c82.png"},1721:function(t,a,e){"use strict";e.r(a);var s=e(42),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"flask-1-1-2-移植指南-openeuler-20-03-lts-sp1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flask-1-1-2-移植指南-openeuler-20-03-lts-sp1"}},[t._v("#")]),t._v(" flask 1.1.2 移植指南（openEuler 20.03 LTS SP1）")]),t._v(" "),s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),s("h3",{attrs:{id:"简要介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简要介绍"}},[t._v("#")]),t._v(" 简要介绍")]),t._v(" "),s("p",[t._v("Flask是一个使用 Python 编写的轻量级 Web 应用框架。其 WSGI 工具箱采用 Werkzeug ，模板引擎则使用 Jinja2 。\n本案例使用x86_64架构虚拟机，通过评估工具x2openEuler评估flask 1.1.2软件移植到openEuler操作系统的兼容性，并根据评估结果完成软件移植。")]),t._v(" "),s("p",[t._v("开发语言：Python")]),t._v(" "),s("p",[t._v("开源协议：BSD")]),t._v(" "),s("h3",{attrs:{id:"建议的版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#建议的版本"}},[t._v("#")]),t._v(" 建议的版本")]),t._v(" "),s("p",[t._v("建议使用版本为flask 1.1.2。")]),t._v(" "),s("blockquote",[s("p",[t._v("说明:\n本文档适用于flask 1.1.2，其他版本的flask移植步骤也可参考本文档。")])]),t._v(" "),s("h2",{attrs:{id:"环境要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[t._v("#")]),t._v(" 环境要求")]),t._v(" "),s("h3",{attrs:{id:"操作系统要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#操作系统要求"}},[t._v("#")]),t._v(" 操作系统要求")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("操作系统")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("版本")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("openEuler")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("20.03 LTS SP1")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("CentOS")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("7.6")])])])]),t._v(" "),s("h3",{attrs:{id:"安装操作系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装操作系统"}},[t._v("#")]),t._v(" 安装操作系统")]),t._v(" "),s("p",[t._v("如果是全新安装操作系统，安装方式建议不要使用最小化安装，否则很多软件包需要手动安装，可选择“Server with GUI”安装方式。\n安装openEuler操作系统请参考："),s("a",{attrs:{href:"https://bbs.huaweicloud.com/forum/thread-116157-1-1.html#",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://openeuler.org/zh/docs/20.03_LTS_SP1/docs/Installation/installation.html。"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"兼容性评估"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#兼容性评估"}},[t._v("#")]),t._v(" 兼容性评估")]),t._v(" "),s("h3",{attrs:{id:"获取flask的rpm包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取flask的rpm包"}},[t._v("#")]),t._v(" 获取flask的RPM包")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("wget https://download-ib01.fedoraproject.org/pub/epel/7/x86_64/Packages/p/python36-flask-1.1.2-4.el7.noarch.rpm\n")])])]),s("h4",{attrs:{id:"下载工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载工具"}},[t._v("#")]),t._v(" 下载工具")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("wget https://repo.oepkgs.net/openEuler/rpm/openEuler-20.03-LTS-SP1/extras-tgz/noarch/x2openEuler-1.0-1.noarch.rpm\n\n用户指南：\nhttps://gitee.com/openeuler/docs/blob/stable2-20.03_LTS_SP1/docs/zh/docs/thirdparty_migration/x2openEuleruseguide.md\n")])])]),s("h4",{attrs:{id:"部署工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署工具"}},[t._v("#")]),t._v(" 部署工具")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("rpm -ivh x2openEuler-1.0-1.noarch.rpm\n")])])]),s("blockquote",[s("p",[t._v("注意：安装rpm时需要使用root用户，且目前需要网络（用于下载安装依赖）\n注意：根据提示安装依赖包如bzip2-devel等")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("su x2openEuler\nx2openEuler redis-db -init\n")])])]),s("blockquote",[s("p",[t._v("依次录入redis数据库的ip:127.0.0.1\n端口：6379\n数据库索引号（0-16）：0\n密码（工具会对密码加密处理）：如果redis密码没有设置或者为空时，直接回车即可")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("x2openEuler init source_centos7.6-openEuler20.03-LTS-SP1.tar.gz\n")])])]),s("blockquote",[s("p",[t._v("备注：x2openEuler使用rpm安装完成后会在/opt/x2openEuler目录下带有source_centos7.6-openEuler20.03-LTS-SP1.tar.gz这个默认资源包\n需要支持centos8.2到openEuler20.03-LTS-SP1的评估，则需获取对应的静态资源包导入，如对应的资源包为source_centos8.2-openEuler20.03-LTS-SP1.tar.gz，导入此包命令："),s("code",[t._v("x2openEuler init source_centos8.2-openEuler20.03-LTS-SP1.tar.gz")]),t._v("，请示情况选择对应的资源包")])]),t._v(" "),s("h4",{attrs:{id:"扫描软件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#扫描软件"}},[t._v("#")]),t._v(" 扫描软件")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("x2openEuler scan python36-flask-1.1.2-4.el7.noarch.rpm\n注意要分析的移植文件需要有能够让x2openEuler用户可以读取的权限\n扫描完成后会在/opt/x2openEuler/output目录生成html格式的报告\n")])])]),s("h2",{attrs:{id:"查看评估结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看评估结果"}},[t._v("#")]),t._v(" 查看评估结果")]),t._v(" "),s("p",[t._v("软件兼容性评估报告分三块内容展示软件兼容性，分别是依赖包兼容性、C/C++接口兼容性、java接口兼容性，依赖包兼容性反映了软件包安装过程中的直接依赖，非100%表明无法正确安装；接口兼容性反映的是单个软件运行过程中对其他软件包、动态库或系统接口的调用变化，非100%表明在某个功能调用时可能会触发异常，未调用到时可能表现正常；部分结果建议人工复核，最终软件包使用建优先级建议 openEuler已移植包>openEuler上人工重编译包>centos软件包。")]),t._v(" "),s("img",{attrs:{src:e(1194)}}),t._v(" "),s("p",[t._v("结果：通过报告可知外部接口兼容性100%，依赖包兼容性人工复核后确认缺失，由于该软件包属于python包，建议使用pip3方式安装依赖及python-flask对应版本。")]),t._v(" "),s("h2",{attrs:{id:"安装flask"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装flask"}},[t._v("#")]),t._v(" 安装flask")]),t._v(" "),s("h3",{attrs:{id:"rpm安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rpm安装"}},[t._v("#")]),t._v(" rpm安装")]),t._v(" "),s("p",[t._v("由于兼容性报告显示依赖包缺失，尝试直接用下载的rpm包安装做个验证。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[root@localhost test]# yum install -y python36-flask-1.1.2-4.el7.noarch.rpm\nLast metadata expiration check: 1:39:08 ago on Mon 22 Mar 2021 10:35:29 AM CST.\nError:\n Problem: conflicting requests\n  - nothing provides python36-setuptools needed by python36-flask-1.1.2-4.el7.noarch\n  - nothing provides python(abi) = 3.6 needed by python36-flask-1.1.2-4.el7.noarch\n  - nothing provides python36-click >= 5.1 needed by python36-flask-1.1.2-4.el7.noarch\n  - nothing provides python36-itsdangerous >= 0.24 needed by python36-flask-1.1.2-4.el7.noarch\n  - nothing provides python36-jinja2 >= 2.10.1 needed by python36-flask-1.1.2-4.el7.noarch\n  - nothing provides python36-werkzeug >= 0.15 needed by python36-flask-1.1.2-4.el7.noarch\n(try to add '--skip-broken' to skip uninstallable packages or '--nobest' to use not only best candidate packages)\n")])])]),s("p",[t._v("由于依赖原因未能安装。")]),t._v(" "),s("h3",{attrs:{id:"pip方式安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pip方式安装"}},[t._v("#")]),t._v(" pip方式安装")]),t._v(" "),s("p",[t._v("使用pip安装同版本的flask，由于flask依赖python3，使用pip3。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[root@localhost ~]# pip3 install flask\nWARNING: Running pip install with root privileges is generally not a good idea. Try `pip3 install --user` instead.\nCollecting flask\n  Using cached Flask-1.1.2-py2.py3-none-any.whl (94 kB)\nRequirement already satisfied: itsdangerous>=0.24 in /usr/lib/python3.7/site-packages (from flask) (1.1.0)\nRequirement already satisfied: Werkzeug>=0.15 in /usr/local/lib/python3.7/site-packages (from flask) (1.0.1)\nRequirement already satisfied: click>=5.1 in /usr/local/lib/python3.7/site-packages (from flask) (7.1.2)\nRequirement already satisfied: Jinja2>=2.10.1 in /usr/lib/python3.7/site-packages (from flask) (2.11.2)\nRequirement already satisfied: MarkupSafe>=0.23 in /usr/lib64/python3.7/site-packages (from Jinja2>=2.10.1->flask) (1.1.1)\nInstalling collected packages: flask\nSuccessfully installed flask-1.1.2\n")])])]),s("h2",{attrs:{id:"运行和验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行和验证"}},[t._v("#")]),t._v(" 运行和验证")]),t._v(" "),s("h3",{attrs:{id:"检查版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检查版本"}},[t._v("#")]),t._v(" 检查版本")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('[root@localhost ~]# python3\nPython 3.7.9 (default, Dec 16 2020, 03:16:57)\n[GCC 7.3.0] on linux\nType "help", "copyright", "credits" or "license" for more information.\n>>> import flask\n>>> flask.__version__\n\'1.1.2\'\n')])])]),s("h3",{attrs:{id:"使用flask"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用flask"}},[t._v("#")]),t._v(" 使用flask")]),t._v(" "),s("p",[t._v("使用flask官网 ("),s("a",{attrs:{href:"https://bbs.huaweicloud.com/forum/thread-115817-1-1.html#",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://flask.palletsprojects.com/en/1.1.x/quickstart/#a-minimal-application"),s("OutboundLink")],1),t._v(") 提供的入门程序")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("vim hello.py\n")])])]),s("p",[t._v("编辑内容如下:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("from flask import Flask\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\n")])])]),s("p",[t._v("编辑后保存退出，在终端输入如下命令：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('[root@localhost ~]# export FLASK_APP=hello.py\n[root@localhost ~]# python3 -m flask run\n * Serving Flask app "hello.py"\n * Environment: production\n   WARNING: This is a development server. Do not use it in a production deployment.\n   Use a production WSGI server instead.\n * Debug mode: off\n * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\n')])])]),s("p",[t._v("可见运行成功。")])])}),[],!1,null,null,null);a.default=r.exports}}]);