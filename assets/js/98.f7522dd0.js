(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{1180:function(t,a,s){t.exports=s.p+"assets/img/HAProxy-1.43c91cef.jpeg"},1181:function(t,a,s){t.exports=s.p+"assets/img/HAProxy-2.769d50c9.png"},1182:function(t,a){t.exports="data:image/png;base64,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"},1710:function(t,a,s){"use strict";s.r(a);var r=s(42),e=Object(r.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"haproxy-1-9-0-移植指南-openeuler-20-03-lts-sp1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#haproxy-1-9-0-移植指南-openeuler-20-03-lts-sp1"}},[t._v("#")]),t._v(" HAProxy 1.9.0 移植指南（openEuler 20.03 LTS SP1）")]),t._v(" "),r("h2",{attrs:{id:"介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),r("h4",{attrs:{id:"简要介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#简要介绍"}},[t._v("#")]),t._v(" 简要介绍")]),t._v(" "),r("p",[t._v("HAProxy是一个使用C语言编写的自由及开放源代码软件，其提供高可用性、负载均衡，以及基于TCP和HTTP的应用程序代理，支持虚拟主机，它是免费、快速并且可靠的一种解决方案。\n开发语言：C")]),t._v(" "),r("p",[t._v("一句话描述：Web负载均衡")]),t._v(" "),r("h4",{attrs:{id:"建议的版本"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#建议的版本"}},[t._v("#")]),t._v(" 建议的版本")]),t._v(" "),r("p",[t._v("建议使用版本为“HAProxy 1.9.0”。")]),t._v(" "),r("p",[t._v("说明：")]),t._v(" "),r("p",[t._v("本文档适用于HAProxy 1.9.0，其他版本的HAProxy移植步骤也可参考本文档。")]),t._v(" "),r("h2",{attrs:{id:"环境要求"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[t._v("#")]),t._v(" 环境要求")]),t._v(" "),r("h4",{attrs:{id:"硬件要求"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#硬件要求"}},[t._v("#")]),t._v(" 硬件要求")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("项目")]),t._v(" "),r("th",[t._v("说明")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("服务器")]),t._v(" "),r("td",[t._v("TaiShan 200服务器（型号2280）")])]),t._v(" "),r("tr",[r("td",[t._v("CPU")]),t._v(" "),r("td",[t._v("鲲鹏920 5250处理器")])]),t._v(" "),r("tr",[r("td",[t._v("磁盘分区")]),t._v(" "),r("td",[t._v("对磁盘分区无要求")])])])]),t._v(" "),r("h4",{attrs:{id:"操作系统要求"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#操作系统要求"}},[t._v("#")]),t._v(" 操作系统要求")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("项目")]),t._v(" "),r("th",[t._v("版本")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("openEuler")]),t._v(" "),r("td",[t._v("20.03 LTS SP1 aarch64")])]),t._v(" "),r("tr",[r("td",[t._v("Kernel")]),t._v(" "),r("td",[t._v("4.19")])])])]),t._v(" "),r("p",[t._v("检查当前系统版本信息")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /etc/os-release\n")])])]),r("img",{attrs:{src:s(1180)}}),t._v(" "),r("p",[t._v("安装openEuler操作系统，请参考https://openeuler.org/zh/docs/20.03_LTS_SP1/docs/Installation/installation.html"),r("br"),t._v("\n说明：\n安装方式建议选择“Server with GUI”安装方式。")]),t._v(" "),r("h2",{attrs:{id:"镜像站rpm方式安装"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#镜像站rpm方式安装"}},[t._v("#")]),t._v(" 镜像站RPM方式安装")]),t._v(" "),r("p",[t._v("若您的服务器可以访问网络，执行 wget https://mirrors.huaweicloud.com/kunpeng/yum/el/7/aarch64/Packages/web/haproxy-1.9.0-1.el7.aarch64.rpm 命令下载RPM包。否则，请访问 https://mirrors.huaweicloud.com/kunpeng/yum/el/7/aarch64/Packages/web/haproxy-1.9.0-1.el7.aarch64.rpm 下载RPM包并复制到服务器“/home”目录。")]),t._v(" "),r("p",[t._v("说明：\n镜像站中的RPM包都是通过开源代码编译打包而成，然后将其上传到镜像站。")]),t._v(" "),r("p",[t._v("以本地下载RPM包并上传到服务器为例说明安装操作")]),t._v(" "),r("ol",{attrs:{start:"2"}},[r("li",[r("p",[t._v("安装HAProxy")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" -ivh haproxy-1.9.0-1.el7.aarch64.rpm\n")])])]),r("img",{attrs:{src:s(1181)}})]),t._v(" "),r("li",[r("p",[t._v("查看安装目录")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /usr/local/haproxy\n")])])]),r("img",{attrs:{src:s(1182)}})])]),t._v(" "),r("h2",{attrs:{id:"运行和验证"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#运行和验证"}},[t._v("#")]),t._v(" 运行和验证")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("配置参数")]),t._v(" "),r("p",[t._v("a. 打开option-http_proxy.cfg文件")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v("  /usr/local/haproxy/conf/option-http_proxy.cfg\n")])])]),r("p",[t._v("b. 修改option-http_proxy.cfg为如下内容后，保存并退出文件")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[t._v("global\nmaxconn      "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("20000")]),t._v("\nlog               "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 local0  info\nuid               "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\ngid               "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("chroot")]),t._v("          /usr/local/haproxy\nnbproc          "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\ndaemon\ndefaults\nmode                       http\nretries                      "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeout")]),t._v(" connect      10s\n"),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeout")]),t._v(" client          20s\n"),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeout")]),t._v(" server         30s\n"),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeout")]),t._v(" check          2s\nfrontend test-proxy\n"),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("bind")]),t._v("            *:80\nmode            http\nlog             global\ndefault_backend test-proxy-srv\nbackend test-proxy-srv\nbalance        roundrobin\noption http-server-close\noption httpchk   GET /index.html\nhttp-check "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),t._v("       status "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\nserver          web1    IP1:PORT1 weight "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nserver          web2    IP2:PORT2 weight "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n")])])]),r("p",[t._v("配置文件示例参数说明见"),r("a",{attrs:{href:"https://support.huaweicloud.com/prtg-kunpengwebs/kunpenghaproxy_02_0011.html#kunpenghaproxy_02_0011__table177828478439",target:"_blank",rel:"noopener noreferrer"}},[t._v("下表"),r("OutboundLink")],1),t._v("。")])])]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("参数")]),t._v(" "),r("th",[t._v("说明")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("global")]),t._v(" "),r("td",[t._v("-")])]),t._v(" "),r("tr",[r("td",[t._v("maxconn 20000")]),t._v(" "),r("td",[t._v("默认最大连接数。")])]),t._v(" "),r("tr",[r("td",[t._v("log 127.0.0.1 local0 info")]),t._v(" "),r("td",[t._v("定义日志输出设备，info表示日志级别。")])]),t._v(" "),r("tr",[r("td",[t._v("uid 0")]),t._v(" "),r("td",[t._v("运行HAProxy的用户id。")])]),t._v(" "),r("tr",[r("td",[t._v("gid 0")]),t._v(" "),r("td",[t._v("运行HAProxy的用户组id。")])]),t._v(" "),r("tr",[r("td",[t._v("chroot /usr/local/haproxy")]),t._v(" "),r("td",[t._v("chroot运行路径。")])]),t._v(" "),r("tr",[r("td",[t._v("nbproc 4")]),t._v(" "),r("td",[t._v("设置进程数量。")])]),t._v(" "),r("tr",[r("td",[t._v("daemon")]),t._v(" "),r("td",[t._v("以后台形式运行HAProxy。")])]),t._v(" "),r("tr",[r("td",[t._v("defaults")]),t._v(" "),r("td",[t._v("-")])]),t._v(" "),r("tr",[r("td",[t._v("mode http")]),t._v(" "),r("td",[t._v("所处理的类别（7层代理http，4层代理tcp）。")])]),t._v(" "),r("tr",[r("td",[t._v("retries 3")]),t._v(" "),r("td",[t._v("设置连接后端服务器的失败重试次数，超过此值标记后端服务器为不可用。")])]),t._v(" "),r("tr",[r("td",[t._v("timeout connect 10s")]),t._v(" "),r("td",[t._v("HAProxy与后端服务器建立连接的最长等待时间。")])]),t._v(" "),r("tr",[r("td",[t._v("timeout client 20s")]),t._v(" "),r("td",[t._v("和客户端保持空闲连接的超时时间。")])]),t._v(" "),r("tr",[r("td",[t._v("timeout server 30s")]),t._v(" "),r("td",[t._v("和服务端保持空闲连接的超时时间。")])]),t._v(" "),r("tr",[r("td",[t._v("timeout check 2s")]),t._v(" "),r("td",[t._v("对服务端的检测超时时间。")])]),t._v(" "),r("tr",[r("td",[t._v("frontend test-proxy")]),t._v(" "),r("td",[t._v("-")])]),t._v(" "),r("tr",[r("td",[t._v("bind *:80")]),t._v(" "),r("td",[t._v("定义一个或几个监测的套接字，*表示当前所有的ipv4地址。")])]),t._v(" "),r("tr",[r("td",[t._v("mode http")]),t._v(" "),r("td",[t._v("所处理的类别（7层代理http，4层代理tcp）。")])]),t._v(" "),r("tr",[r("td",[t._v("log global")]),t._v(" "),r("td",[t._v("继承global中log的定义。")])]),t._v(" "),r("tr",[r("td",[t._v("default_backend test-proxy-srv")]),t._v(" "),r("td",[t._v("指定默认的后端服务器池。")])]),t._v(" "),r("tr",[r("td",[t._v("backend test-proxy-srv")]),t._v(" "),r("td",[t._v("-")])]),t._v(" "),r("tr",[r("td",[t._v("balance roundrobin")]),t._v(" "),r("td",[t._v("指定负载均衡算法 roundrobin是基于权重进行轮询的算法，适用于服务器性能均匀时。")])]),t._v(" "),r("tr",[r("td",[t._v("option http-server-")]),t._v(" "),r("td",[t._v("当开启长连接时，应该开启此项。")])]),t._v(" "),r("tr",[r("td",[t._v("option httpchk GET /index.htmlhttp-check expect status 200")]),t._v(" "),r("td",[t._v("启用HTTP的服务状态检测（健康检查）。检查返回的状态码，接受不到200就不给后端server调度。")])]),t._v(" "),r("tr",[r("td",[t._v("server web1IP1:PORT1 weight 3 server web2 IP2:PORT2 weight 3")]),t._v(" "),r("td",[t._v("定义多个后端真实服务器。格式：server  :[port] [param*]**说明：**IP1:PORT1和IP2:PORT2为后端服务器IP及端口号。weight表示权重。")])])])]),t._v(" "),r("ul",[r("li",[r("p",[t._v("启动HAProxy")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[t._v("taskset -c "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("-3 /usr/local/haproxy/sbin/haproxy -f /usr/local/haproxy/conf/option-http_proxy.cfg\n")])])])]),t._v(" "),r("li",[r("p",[t._v("验证HAProxy")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" haproxy\n")])])]),r("p",[t._v("可以看到HAProxy进程。")]),t._v(" "),r("p",[t._v("打开浏览器在url处输入：http://IP:80，（IP为HAproxy所在服务器IP）可以看到后端服务器的页面，则说明HAProxy运行成功。刷新页面，显示页面在后端服务器间来回切换。")]),t._v(" "),r("p",[t._v("说明：")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("（可选）停止HAProxy命令如下，业务运行中不需要执行该命令。")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("pkill")]),t._v(" haproxy\n")])])])]),t._v(" "),r("li",[r("p",[t._v("（可选）卸载HAProxy，并查询。")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" -qa "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" haproxy\n")])])]),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" -e --nodeps haproxy-1.9.0\n")])])]),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" -qa "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" haproxy\n")])])]),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf /usr/local/haproxy\n")])])])])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);