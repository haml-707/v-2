(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{1186:function(t,a,e){t.exports=e.p+"assets/img/Memcached-1.43c91cef.jpeg"},1187:function(t,a,e){t.exports=e.p+"assets/img/Memcached-2.aee51ba5.jpeg"},1713:function(t,a,e){"use strict";e.r(a);var s=e(42),v=Object(s.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"memcached-1-5-12-移植指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#memcached-1-5-12-移植指南"}},[t._v("#")]),t._v(" Memcached 1.5.12 移植指南")]),t._v(" "),s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),s("h4",{attrs:{id:"简要介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简要介绍"}},[t._v("#")]),t._v(" 简要介绍")]),t._v(" "),s("p",[t._v("Memcached是LiveJournal旗下Danga Interactive公司以Brad Fitzpatric为首开发的一款高性能分布式内存对象缓存系统，通过缓存数据库查询结果，减少数据库访问次数，来提高动态Web应用的访问速度、提高可扩展性。")]),t._v(" "),s("p",[t._v("Memcached的官方链接：https://memcached.org/")]),t._v(" "),s("p",[t._v("开发语言：C")]),t._v(" "),s("p",[t._v("一句话描述：分布式内存对象缓存系统")]),t._v(" "),s("h2",{attrs:{id:"环境要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[t._v("#")]),t._v(" 环境要求")]),t._v(" "),s("h4",{attrs:{id:"硬件要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#硬件要求"}},[t._v("#")]),t._v(" 硬件要求")]),t._v(" "),s("p",[t._v("硬件要求如下表所示。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("项目")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("服务器")]),t._v(" "),s("td",[t._v("TaiShan 200服务器（型号2280）")])]),t._v(" "),s("tr",[s("td",[t._v("CPU")]),t._v(" "),s("td",[t._v("鲲鹏920 5250处理器")])]),t._v(" "),s("tr",[s("td",[t._v("磁盘分区")]),t._v(" "),s("td",[t._v("对磁盘分区无要求")])])])]),t._v(" "),s("h4",{attrs:{id:"操作系统要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#操作系统要求"}},[t._v("#")]),t._v(" 操作系统要求")]),t._v(" "),s("p",[t._v("操作系统要求如下表所示。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("项目")]),t._v(" "),s("th",[t._v("版本")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("openEuler")]),t._v(" "),s("td",[t._v("20.03 LTS SP1 aarch64")])]),t._v(" "),s("tr",[s("td",[t._v("Kernel")]),t._v(" "),s("td",[t._v("4.19")])])])]),t._v(" "),s("p",[t._v("查询当前系统版本信息")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("cat /etc/os-release\n")])])]),s("img",{attrs:{src:e(1186)}}),t._v(" "),s("p",[t._v("安装openEuler操作系统，请参考https://openeuler.org/zh/docs/20.03_LTS_SP1/docs/Installation/installation.html"),s("br"),t._v("\n说明：\n安装方式建议选择“Server with GUI”安装方式。")]),t._v(" "),s("h2",{attrs:{id:"配置编译环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置编译环境"}},[t._v("#")]),t._v(" 配置编译环境")]),t._v(" "),s("p",[t._v("编译Memcached需要准备C编译器、GNU、make、automake、libevent和libevent-devel。")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("安装gcc，已安装则跳过")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" gcc gcc-c++ kernel-devel \n")])])])]),t._v(" "),s("li",[s("p",[t._v("安装GNU make和automake、unzip、telnet，已安装则跳过")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" automake "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v(" telnet\n")])])])]),t._v(" "),s("li",[s("p",[t._v("安装libevent和libevent-devel")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("yum -y "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" libevent libevent-devel\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"获取源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取源码"}},[t._v("#")]),t._v(" 获取源码")]),t._v(" "),s("p",[t._v("若您的服务器可以访问网络，执行 wget https://github.com/memcached/memcached/archive/1.5.12.zip 命令下载源码。否则，请访问 https://github.com/memcached/memcached/archive/1.5.12.zip 下载源码并复制到服务器“/home”目录。")]),t._v(" "),s("h2",{attrs:{id:"编译和安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编译和安装"}},[t._v("#")]),t._v(" 编译和安装")]),t._v(" "),s("p",[t._v("以本地下载源码并上传到服务器为例说明编译和安装操作")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("解压源码包")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /home\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("unzip")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.5")]),t._v(".12.zip\n")])])])]),t._v(" "),s("li",[s("p",[t._v("进入“memcached-1.5.12”目录")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" memcached-1.5.12\n")])])])]),t._v(" "),s("li",[s("p",[t._v("配置Memcached")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" autogen.sh\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./configure --prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/opt/memcached\n")])])]),s("p",[t._v("可在该步骤指定Memcached安装目录，例如本文指定安装在“/opt/memcached”目录下。")])]),t._v(" "),s("li",[s("p",[t._v("执行编译")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" -j60\n")])])]),s("p",[t._v("-j60参数充分利用多核CPU优势，加快编译速度。")])]),t._v(" "),s("li",[s("p",[t._v("执行安装")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("make")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("进入指定的Memcached安装目录“/opt/memcached”，若生成的“bin”目录中出现“memcached”可执行文件，说明编译安装完成")])]),t._v(" "),s("li",[s("p",[t._v("配置环境变量")]),t._v(" "),s("p",[t._v("a. 将以下命令添加至“/etc/profile”文件中")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/opt/memcached/bin/:"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v("\n")])])]),s("p",[t._v("b. 使环境变量生效")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" /etc/profile\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"运行和验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行和验证"}},[t._v("#")]),t._v(" 运行和验证")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("使用命令启动")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("memcached -t "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" -p "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11211")]),t._v(" -u root -m "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("49152")]),t._v(" -c "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10240")]),t._v("\n")])])]),s("p",[t._v("启动命令参数说明如下表所示。")])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("命令参数")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("默认值")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("-t")]),t._v(" "),s("td",[t._v("线程数。")]),t._v(" "),s("td",[t._v("4")])]),t._v(" "),s("tr",[s("td",[t._v("-p")]),t._v(" "),s("td",[t._v("监测的TCP端口。")]),t._v(" "),s("td",[t._v("11211")])]),t._v(" "),s("tr",[s("td",[t._v("-u")]),t._v(" "),s("td",[t._v("指定用户启动。")]),t._v(" "),s("td",[t._v("默认不能用root用户启动进程")])]),t._v(" "),s("tr",[s("td",[t._v("-m")]),t._v(" "),s("td",[t._v("分配给Memcached的内存大小。单位：MB。")]),t._v(" "),s("td",[t._v("64M")])]),t._v(" "),s("tr",[s("td",[t._v("-c")]),t._v(" "),s("td",[t._v("最大并发连接数。")]),t._v(" "),s("td",[t._v("1024")])]),t._v(" "),s("tr",[s("td",[t._v("-d")]),t._v(" "),s("td",[t._v("后台启动一个守护进程。")]),t._v(" "),s("td",[t._v("-")])])])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("另外启动一个Shell窗口，连接到Memcached")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("telnet "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11211")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("创建连接之后，可使用stats命令获取到Memcached服务端的统计信息")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("stats\n")])])]),s("img",{attrs:{src:e(1187)}})])]),t._v(" "),s("p",[t._v("常用的stats命令如"),s("a",{attrs:{href:"https://support.huaweicloud.com/prtg-kunpengwebs/kunpengmemcached_02_0006.html#kunpengmemcached_02_0006__table1896316817714",target:"_blank",rel:"noopener noreferrer"}},[t._v("下表"),s("OutboundLink")],1),t._v("所示。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("命令")]),t._v(" "),s("th",[t._v("功能")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("stats")]),t._v(" "),s("td",[t._v("显示Memcached总体状态信息，包括启动时间、存储数据量、缓存命中率、当前连接数等。")])]),t._v(" "),s("tr",[s("td",[t._v("stats items")]),t._v(" "),s("td",[t._v("输出各个slab中item的信息。")])]),t._v(" "),s("tr",[s("td",[t._v("stats slabs")]),t._v(" "),s("td",[t._v("输出更详细的slab信息。")])]),t._v(" "),s("tr",[s("td",[t._v("stats sizes")]),t._v(" "),s("td",[t._v("显示所有item的大小和个数。")])]),t._v(" "),s("tr",[s("td",[t._v("stats cachedump")]),t._v(" "),s("td",[t._v("导出下的数据，是输出个数，若传入0则输出该slab下所有数据。")])]),t._v(" "),s("tr",[s("td",[t._v("stats detail")]),t._v(" "),s("td",[t._v("设置（on/off）或显示（dump）详细操作记录，如get/set操作。")])]),t._v(" "),s("tr",[s("td",[t._v("flush_all")]),t._v(" "),s("td",[t._v("使内存中所有item失效，该操作并不会暂停服务端，因为不会真正释放内存空间，而是将现有item标记为失效状态。")])])])]),t._v(" "),s("p",[t._v("说明：\n如需退出Telnet连接可执行"),s("strong",[t._v("quit")]),t._v("命令。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("quit\n")])])]),s("p",[t._v("除Telnet连接Memcached服务获取数据信息以外，源码中还提供了一些工具脚本，可以直接使用，如memcached-tool，位于源码中的scripts目录下。")]),t._v(" "),s("p",[t._v("memcached-tool的使用方法如"),s("a",{attrs:{href:"https://support.huaweicloud.com/prtg-kunpengwebs/kunpengmemcached_02_0006.html#kunpengmemcached_02_0006__table15821759181818",target:"_blank",rel:"noopener noreferrer"}},[t._v("下表"),s("OutboundLink")],1),t._v("所示。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("命令")]),t._v(" "),s("th",[t._v("功能")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("./memcached-tool localhost display")]),t._v(" "),s("td",[t._v("显示slabs信息")])]),t._v(" "),s("tr",[s("td",[t._v("./memcached-tool 10.0.0.5:11211 display")]),t._v(" "),s("td",[t._v("显示slabs信息")])]),t._v(" "),s("tr",[s("td",[t._v("./memcached-tool 10.0.0.5:11211 stats")]),t._v(" "),s("td",[t._v("显示Memcached统计信息")])]),t._v(" "),s("tr",[s("td",[t._v("./memcached-tool 10.0.0.5:11211 settings")]),t._v(" "),s("td",[t._v("显示Memcached设置信息")])]),t._v(" "),s("tr",[s("td",[t._v("./memcached-tool 10.0.0.5:11211 sizes")]),t._v(" "),s("td",[t._v("显示items的大小和个数")])]),t._v(" "),s("tr",[s("td",[t._v("./memcached-tool 10.0.0.5:11211 dump [limit]")]),t._v(" "),s("td",[t._v("导出缓存中的Keys和Values")])])])])])}),[],!1,null,null,null);a.default=v.exports}}]);